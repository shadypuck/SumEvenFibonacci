\documentclass[titlepage]{article}

\usepackage[letterpaper,margin=1in,footskip=0.25in]{geometry}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage{mdframed}
\usepackage{amsmath,amssymb,mathtools}
\usepackage{enumitem}
\usepackage{scrextend}
\usepackage{listings}
\usepackage[hidelinks]{hyperref}

\newmdenv[
    backgroundcolor=yellow!80!red!10,
    linewidth=0pt,
    innertopmargin=\topskip,
    innerbottommargin=\topskip
]{prob}

\deffootnotemark{\textsuperscript{[\thefootnotemark]}}
\deffootnote[1.8em]{0em}{1.6em}{\textsuperscript{\thefootnotemark}}

\renewcommand{\ttdefault}{pcr}
\definecolor{eminence}{RGB}{108,48,130}
\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    keywordstyle=\mdseries\color{eminence},
    emph={return},emphstyle=\color{eminence},
    emph={[2]sumEvenFibonaccisBeneath},emphstyle={[2]\color{blue!50!black}},
    emph={[3]int},emphstyle={[3]\color{green!70!blue}},
    literate=
    {0}{{{\color{blue!50!black}0}}}1
    {1}{{{\color{blue!50!black}1}}}1
    {2}{{{\color{blue!50!black}2}}}1
    {3}{{{\color{blue!50!black}3}}}1
    {4}{{{\color{blue!50!black}4}}}1
    {5}{{{\color{blue!50!black}5}}}1
    {6}{{{\color{blue!50!black}6}}}1
    {7}{{{\color{blue!50!black}7}}}1
    {8}{{{\color{blue!50!black}8}}}1
    {9}{{{\color{blue!50!black}9}}}1
}

\newcommand{\qed}{
    \begin{flushright}
        $\blacksquare$
    \end{flushright}
}

\newcounter{postulate}
\newcounter{theorem}

\newenvironment{postulate}[1]{
    \refstepcounter{postulate}\label{#1}
    \paragraph{Postulate \thepostulate}\hangindent=15pt 
}{}
\newenvironment{theorem}[2]{
    \setenumerate{itemindent=15pt}
    \refstepcounter{theorem}\label{#1}
    \paragraph{Theorem \thetheorem}\hangindent=15pt #2

    \setlength{\leftskip}{15pt}
    \subparagraph{\hspace{-15pt}Proof}
}{

    \setlength{\leftskip}{0pt}
    \qed
}

\title{Summing the Even Fibonacci Numbers Beneath an Upper Bound}
\author{Steven Labalme}
\date{\today}

\begin{document}




\pagenumbering{gobble}
\maketitle



\pagenumbering{roman}
\tableofcontents
\newpage



\pagenumbering{arabic}
\pagestyle{fancy}
\fancyhf{}
\rfoot{Labalme \thepage}
\renewcommand{\headrulewidth}{0pt}
\begin{center}
    \setcounter{secnumdepth}{0}
    \section{Abstract}
    \setcounter{secnumdepth}{3}
\end{center}
This paper was inspired by Problem 2 of Project Euler, which is restated below for convenience.

\vspace{8pt}
\begin{prob}
    \begin{description}
        \item[Problem 2] \hfill \\ Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:
        \begin{equation*}
            1,\ 2,\ 3,\ 5,\ 8,\ 13,\ 21,\ 34,\ 55,\ 89,\ \dots
        \end{equation*}
        By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.
    \end{description}
\end{prob}

The typical method of solving Problem 2 would be to write a program that generates all Fibonacci numbers under four million, finds the ones that are even, and sums those numbers. While this is an acceptable, quick, and elegant method, the problem can actually be solved algebraically in its entirety. This paper explores this purely mathematical method.\par
To that end, this paper will begin by discussing and proving a couple of properties of the even Fibonacci numbers. Next, it will use Markov chains to simultaneously\footnote{Flex.} derive closed-form expressions for the $n^\text{th}$ even Fibonacci number and the sum of the first $n$ even Fibonacci numbers. The summation equation is evidently useful, but the $n^\text{th}$ term equation on its own will not help to solve Problem 2. However, its inverse (which takes in a Fibonacci number and returns $n$) can be used to determine how many even Fibonacci numbers there are below a certain upper bound (four million, per se).\par
With an expression capable of finding the number $n$ of even Fibonacci numbers beneath four million and another capable of summing the first $n$ even Fibonacci numbers, all that is left is to combine the two results, solving Problem 2. As a final touch, the results will be implemented in Python.
\newpage



\section{Properties of the Even Fibonacci Numbers}
\subsection{Every Third Fibonacci Number is Even}
The Fibonacci sequence begins as follows.
\begin{equation*}
    1,\ 1,\ 2,\ 3,\ 5,\ 8,\ 13,\ 21,\ 34,\ 55,\ 89,\ 144,\ \dots
\end{equation*}
From these first 12 terms, one might suspect that every third term is even (based on the fact that 2, 8, 34, and 144 are even), all others being odd. However, to do one better, this will be proved.\par
This proof considers the following three postulates to be self-evident.
\begin{postulate}{pst:oddodd}
    The sum of two odd integers is even.
\end{postulate}
\begin{postulate}{pst:eveneven}
    The sum of two even integers is even.
\end{postulate}
\begin{postulate}{pst:oddeven}
    The sum of an odd integer and an even integer is odd.
\end{postulate}\\
\medskip

Now the theorem can be proved.
\begin{theorem}{trm:even3Fibonacci}{
    Every third Fibonacci number is even and all other Fibonacci numbers are odd.
}
    This will be an induction proof.\\
    Basis step: 1, 1, 2 is odd, odd, even.\\
    Induction hypothesis: The next three Fibonacci numbers are odd, odd, even.\\
    Induction step:
    \begin{align*}
        \text{odd, odd, even} &\stackrel{?}{=} \text{(even+odd), ((even+odd)+even), (((even+odd)+even)+(even+odd))}\\
        &\stackrel{?}{=} \text{(even+odd), ((even+even)+odd), ((even+even+even)+(odd+odd))}\\
        &\stackrel{?}{=} \text{(even+odd), (even+odd), (even+even)}\\
        &\stackrel{\checkmark}{=} \text{odd, odd, even}
    \end{align*}
\end{theorem}


\subsection{The Even Fibonacci Numbers Are Recursively Defined}\label{sss:evenRecursive}
The Fibonacci numbers are defined by the following recursive formula, where $n\geq 2$
\begin{equation*}
    F_n = F_{n-1}+F_{n-2}
\end{equation*}
with the following initial conditions.
\begin{align*}
    F_0 &= 1&
        F_1 &= 1
\end{align*}\par
The recursive formula can be manipulated as follows.
\begin{align*}
    F_n &= F_{n-1}+F_{n-2}\\
    &= (F_{n-2}+F_{n-3})+(F_{n-3}+F_{n-4})\\
    &= ((F_{n-3}+F_{n-4})+F_{n-3})+(F_{n-3}+(F_{n-5}+F_{n-6}))\\
    &= 3F_{n-3}+(F_{n-4}+F_{n-5})+F_{n-6}\\
    &= 3F_{n-3}+F_{n-3}+F_{n-6}\\
    &= 4F_{n-3}+F_{n-6}
\end{align*}
The above proves that every Fibonacci number such that $n\geq 6$ can be defined in terms of the Fibonacci numbers 3 and 6 before it in the Fibonacci sequence. The implication (for the purposes of this paper) is that every even Fibonacci number can be defined in terms of other even Fibonacci numbers. In essence, if $E_n$ is the $n^\text{th}$ even Fibonacci number, then the following holds for all even Fibonacci numbers, where $n\geq 2$.
\begin{equation*}
    E_n = 4E_{n-1}+E_{n-2}
\end{equation*}
The initial conditions are given by the following.
\begin{align*}
    E_0 &= 2&
        E_1 &= 8
\end{align*}
\newpage



\section{Formulas for the Even Fibonacci Numbers and Their Sum}
\subsection{Even Fibonacci Numbers and Their Sum in Terms of \emph{n}}
In the same way that Binet's formula is a closed-form expression for the Fibonacci sequence, there exists a closed-form expression for the even Fibonacci sequence. Similarly, there exists a closed-form expression for the sum of the even Fibonacci sequence. Through the beauty of Markov chains, both can be derived simultaneously.\par
Before beginning, a note on notation: From here on out, $e_n$ refers to the $n^\text{th}$ term in the even Fibonacci sequence, where 2 is the $0^\text{th}$ term. Likewise, $s_n$ refers to the sum of all terms through the $n^\text{th}$ term in the even Fibonacci sequence. Additionally, $E_n$ refers to a vector in the following form.
\begin{equation*}
    E_n =
    \begin{bmatrix}
        s_n\\
        e_n\\
        e_{n-1}\\
    \end{bmatrix}
\end{equation*}
Lastly, $E$ refers to the matrix that linearly maps $E_{n-1}$ to $E_n$.\par
To begin constructing the Markov chain, first consider the initial conditions. The initial conditions for the even Fibonacci sequence were discussed in Section \ref{sss:evenRecursive}, and their sum is the initial condition for the sum of the even Fibonacci sequence. Put them into an initial conditions vector.
\begin{equation*}
    E_1 =
    \begin{bmatrix}
        10\\
        8\\
        2\\
    \end{bmatrix}
\end{equation*}
It is necessary to find a matrix $E$ that maps $E_{n-1}$ to $E_n$. Using the recursive formula from Section \ref{sss:evenRecursive}, define a general $E_n$ vector in terms of the elements of $E_{n-1}$.
\begin{equation*}
    \begin{bmatrix}
        s_n\\
        e_n\\
        e_{n-1}\\
    \end{bmatrix}
    =
    \begin{bmatrix}
        s_{n-1}+(4e_{n-1}+e_{n-2})\\
        4e_{n-1}+e_{n-2}\\
        e_{n-1}\\
    \end{bmatrix}
\end{equation*}
Manipulate the above equation as follows to find $E$.
\begin{align*}
    \begin{bmatrix}
        s_n\\
        e_n\\
        e_{n-1}\\
    \end{bmatrix}
    &=
    \begin{bmatrix}
        1s_{n-1}+4e_{n-1}+1e_{n-1}\\
        0s_{n-1}+4e_{n-1}+1e_{n-2}\\
        0s_{n-1}+1e_{n-1}+0e_{n-2}\\
    \end{bmatrix}\\
    \underbrace{
        \begin{bmatrix}
            s_n\\
            e_n\\
            e_{n-1}\\
        \end{bmatrix}
    }_{E_n}
    &=
    \underbrace{
        \begin{bmatrix}
            1 & 4 & 1\\
            0 & 4 & 1\\
            0 & 1 & 0\\
        \end{bmatrix}
    }_E
    \underbrace{
        \begin{bmatrix}
            s_{n-1}\\
            e_{n-1}\\
            e_{n-2}\\
        \end{bmatrix}
    }_{E_{n-1}}
\end{align*}\par
The equation $E_n=EE_{n-1}$ relatively defines the Markov chain specific to the even Fibonacci numbers. Coupled with the above $E_1$ vector, it can be modified to define the Markov chain absolutely as follows.
\begin{equation*}
    E_n = E^{n-1}E_1
\end{equation*}
From this equation, the sought-after explicit formulas can be found.\par
To facilitate raising $E$ to a power, diagonalize it. Begin by finding the eigenvalues $\lambda_1$, $\lambda_2$, and $\lambda_3$.
\begin{align*}
    0 &=
    \begin{vmatrix}
        1-\lambda & 4 & 1\\
        0 & 4-\lambda & 1\\
        0 & 1 & -\lambda\\
    \end{vmatrix}\\
    &= (1)((1-\lambda)(1)-(1)(0))(-1)^{3+2}+(-\lambda)((1-\lambda)(4-\lambda)-(4)(0))(-1)^{3+3}\\
    &= (\lambda-1)+(-\lambda)(1-\lambda)(4-\lambda)\\
    &= (\lambda-1)+(\lambda)(\lambda-1)(4-\lambda)\\
    &= (\lambda-1)(1+(\lambda)(4-\lambda))\\
    &= (\lambda-1)(1+4\lambda-\lambda^2)
\end{align*}
\begin{align*}
    \lambda_1 &= 1&
        \lambda_2 &= \frac{-(4)-\sqrt{(4)^2-4(-1)(1)}}{2(-1)}&
            \lambda_3 &= \frac{-(4)+\sqrt{(4)^2-4(-1)(1)}}{2(-1)}\\
    &&
        &= \frac{-4-\sqrt{16+4}}{-2}&
            &= \frac{-4+\sqrt{16+4}}{-2}\\
    &&
        &= \frac{-4-\sqrt{4\cdot 5}}{-2}&
            &= \frac{-4+\sqrt{4\cdot 5}}{-2}\\
    &&
        &= 2+\sqrt{5}&
            &= 2-\sqrt{5}
\end{align*}
Next, find the eigenvectors $x_1$, $x_2$, and $x_3$ (the author did so by inspection).
\begin{align*}
    0 &= (E-\lambda_1I)x_1\\
    \begin{bmatrix}
        0\\
        0\\
        0\\
    \end{bmatrix}
    &=
    \begin{bmatrix}
        1-1 & 4 & 1\\
        0 & 4-1 & 1\\
        0 & 1 & -1\\
    \end{bmatrix}
    \begin{bmatrix}
        x_{1_1}\\
        x_{1_2}\\
        x_{1_3}\\
    \end{bmatrix}\\
    &=
    \begin{bmatrix}
        0 & 4 & 1\\
        0 & 3 & 1\\
        0 & 1 & -1\\
    \end{bmatrix}
    \begin{bmatrix}
        1\\
        0\\
        0\\
    \end{bmatrix}
\end{align*}
\begin{align*}
    0 &= (E-\lambda_2I)x_2\\
    \begin{bmatrix}
        0\\
        0\\
        0\\
    \end{bmatrix}
    &=
    \begin{bmatrix}
        1-(2+\sqrt{5}) & 4 & 1\\
        0 & 4-(2+\sqrt{5}) & 1\\
        0 & 1 & -(2+\sqrt{5})\\
    \end{bmatrix}
    \begin{bmatrix}
        x_{2_1}\\
        x_{2_2}\\
        x_{2_3}\\
    \end{bmatrix}\\
    &=
    \begin{bmatrix}
        -1-\sqrt{5} & 4 & 1\\
        0 & 2-\sqrt{5} & 1\\
        0 & 1 & -2-\sqrt{5}\\
    \end{bmatrix}
    \begin{bmatrix}
        11+5\sqrt{5}\\
        8+4\sqrt{5}\\
        4\\
    \end{bmatrix}
\end{align*}
\begin{align*}
    0 &= (E-\lambda_3I)x_3\\
    \begin{bmatrix}
        0\\
        0\\
        0\\
    \end{bmatrix}
    &=
    \begin{bmatrix}
        1-(2-\sqrt{5}) & 4 & 1\\
        0 & 4-(2-\sqrt{5}) & 1\\
        0 & 1 & -(2-\sqrt{5})\\
    \end{bmatrix}
    \begin{bmatrix}
        x_{3_1}\\
        x_{3_2}\\
        x_{3_3}\\
    \end{bmatrix}\\
    &=
    \begin{bmatrix}
        -1+\sqrt{5} & 4 & 1\\
        0 & 2+\sqrt{5} & 1\\
        0 & 1 & -2+\sqrt{5}\\
    \end{bmatrix}
    \begin{bmatrix}
        11-5\sqrt{5}\\
        8-4\sqrt{5}\\
        4\\
    \end{bmatrix}
\end{align*}
Now assemble the full factorization. $S$ and $\Lambda$ are already there in pieces; only $S^{-1}$ is left to find. $S^{-1}$ can be found via the cofactor method of inversion.
\begin{equation*}
    E = \frac{1}{32\sqrt{5}}
    \begin{bmatrix}
        1 & 11+5\sqrt{5} & 11-5\sqrt{5}\\
        0 & 8+4\sqrt{5} & 8-4\sqrt{5}\\
        0 & 4 & 4\\
    \end{bmatrix}
    \begin{bmatrix}
        1 & 0 & 0\\
        0 & 2+\sqrt{5} & 0\\
        0 & 0 & 2-\sqrt{5}\\
    \end{bmatrix}
    \begin{bmatrix}
        32\sqrt{5} & -40\sqrt{5} & -8\sqrt{5}\\
        0 & 4 & -8+4\sqrt{5}\\
        0 & -4 & 8+4\sqrt{5}\\
    \end{bmatrix}
\end{equation*}\par
Aided by the diagonalization, it is now possible to determine an explicit formula for $E_n$ for any power $n$. To finish the job, compile $E_n = S\Lambda^{n-1}S^{-1}E_1$.
\begingroup
\allowdisplaybreaks
\begin{align*}
    \begin{bmatrix}
        s_n\\
        e_n\\
        e_{n-1}\\
    \end{bmatrix}
    &= \frac{1}{32\sqrt{5}}
    \begin{bmatrix}
        1 & 11+5\sqrt{5} & 11-5\sqrt{5}\\
        0 & 8+4\sqrt{5} & 8-4\sqrt{5}\\
        0 & 4 & 4\\
    \end{bmatrix}
    \begin{bmatrix}
        1 & 0 & 0\\
        0 & 2+\sqrt{5} & 0\\
        0 & 0 & 2-\sqrt{5}\\
    \end{bmatrix}^{n-1}
    \begin{bmatrix}
        32\sqrt{5} & -40\sqrt{5} & -8\sqrt{5}\\
        0 & 4 & -8+4\sqrt{5}\\
        0 & -4 & 8+4\sqrt{5}\\
    \end{bmatrix}
    \begin{bmatrix}
        10\\
        8\\
        2\\
    \end{bmatrix}\\
    &= \frac{1}{32\sqrt{5}}
    \begin{bmatrix}
        1 & 11+5\sqrt{5} & 11-5\sqrt{5}\\
        0 & 8+4\sqrt{5} & 8-4\sqrt{5}\\
        0 & 4 & 4\\
    \end{bmatrix}
    \begin{bmatrix}
        1^{n-1} & 0 & 0\\
        0 & (2+\sqrt{5})^{n-1} & 0\\
        0 & 0 & (2-\sqrt{5})^{n-1}\\
    \end{bmatrix}
    \begin{bmatrix}
        -16\sqrt{5}\\
        16+8\sqrt{5}\\
        -16+8\sqrt{5}\\
    \end{bmatrix}\\
    &= \frac{1}{32\sqrt{5}}
    \begin{bmatrix}
        1 & 11+5\sqrt{5} & 11-5\sqrt{5}\\
        0 & 8+4\sqrt{5} & 8-4\sqrt{5}\\
        0 & 4 & 4\\
    \end{bmatrix}
    \begin{bmatrix}
        -16\sqrt{5}\\
        (2+\sqrt{5})^{n-1}(16+8\sqrt{5})\\
        (2-\sqrt{5})^{n-1}(-16+8\sqrt{5})\\
    \end{bmatrix}\\
    &= \frac{1}{32\sqrt{5}}
    \begin{bmatrix}
        (376+168\sqrt{5})(2+\sqrt{5})^{n-1}+(-376+168\sqrt{5})(2-\sqrt{5})^{n-1}-16\sqrt{5}\\
        (288+128\sqrt{5})(2+\sqrt{5})^{n-1}+(-288+128\sqrt{5})(2-\sqrt{5})^{n-1}\\
        (64+32\sqrt{5})(2+\sqrt{5})^{n-1}+(-64+32\sqrt{5})(2-\sqrt{5})^{n-1}\\
    \end{bmatrix}\\
    &=
    \renewcommand{\arraystretch}{1.6}
    \begin{bmatrix}
        \frac{(5-\sqrt{5})(2+\sqrt{5})^{n+2}+(5+\sqrt{5})(2-\sqrt{5})^{n+2}-10}{20}\\
        \frac{(2+\sqrt{5})^{n+1}-(2-\sqrt{5})^{n+1}}{\sqrt{5}}\\
        \frac{(2+\sqrt{5})^n-(2-\sqrt{5})^n}{\sqrt{5}}\\
    \end{bmatrix}
\end{align*}
\endgroup
The uppermost value in $E_n$ corresponds to an explicit formula for $s_n$, and the middle value in $E_n$ corresponds to an explicit formula for $e_n$, as desired. The results are transcribed below for clarity.
\begin{equation}\label{eqn:s_n}
    s_n = \frac{1}{20}\left( \left( 5-\sqrt{5} \right)\left( 2+\sqrt{5} \right)^{n+2}+\left( 5+\sqrt{5} \right)\left( 2-\sqrt{5} \right)^{n+2}-10 \right)
\end{equation}
\begin{equation}\label{eqn:e_n}
    e_n = \frac{1}{\sqrt{5}}\left( \left( 2+\sqrt{5} \right)^{n+1}-\left( 2-\sqrt{5} \right)^{n+1} \right)
\end{equation}


\subsection{\emph{n} in Terms of an Even Fibonacci Number}
This section looks to solve for $n$ in Equation \ref{eqn:e_n}. This is not entirely possible, but a workable-enough solution can be found to suit the purpose of solving Problem 2.\par
In Equation \ref{eqn:e_n}, there are two different bases being raised to exponents. The first step is to express one in terms of the other. This can be accomplished as follows.
\begin{align*}
    (2-\sqrt{5})^n &= \left( \frac{1}{2-\sqrt{5}} \right)^{-n}\\
    &= \left( \frac{1}{2-\sqrt{5}}\cdot\frac{2+\sqrt{5}}{2+\sqrt{5}} \right)^{-n}\\
    &= \left( \frac{2+\sqrt{5}}{4-5} \right)^{-n}\\
    &= \left( \frac{1}{-1} \right)^{-n}\left( 2+\sqrt{5} \right)^{-n}\\
    &= (-1)^n\left( 2+\sqrt{5} \right)^{-n}
\end{align*}
Substitute the above result into Equation \ref{eqn:e_n}\footnote{Note that it is the pesky $(-1)^n$ term that makes it impossible to \emph{exactly} solve this equation for $n$.}.
\begin{equation*}
    e_n = \frac{1}{\sqrt{5}}\left( \left( 2+\sqrt{5} \right)^{n+1}-(-1)^{n+1}\left( 2+\sqrt{5} \right)^{-(n+1)} \right)
\end{equation*}\par
For simplicity's sake, let $\gamma=2+\sqrt{5}$. After making the substitution, perform the following algebraic manipulations to yield a quadratic equation in $\gamma^{n+1}$.
\begin{align*}
    e_n &= \frac{1}{\sqrt{5}}\left( \gamma^{n+1}-(-1)^{n+1}\gamma^{-(n+1)} \right)\\
    e_n\sqrt{5} &= \gamma^{n+1}-(-1)^{n+1}\gamma^{-(n+1)}\\
    e_n\sqrt{5}\gamma^{n+1} &= \gamma^{n+1}\gamma^{n+1}-(-1)^{n+1}\gamma^{-(n+1)}\gamma^{n+1}\\
    0 &= \gamma^{2n+2}-e_n\sqrt{5}\gamma^{n+1}-(-1)^{n+1}
\end{align*}
Use the quadratic formula to solve for $\gamma^{n+1}$.
\begin{align*}
    \gamma^{n+1} &= \frac{-(-e_n\sqrt{5})\pm\sqrt{(-e_n\sqrt{5})^2-4(1)(-(-1)^{n+1})}}{2(1)}\\
    &= \frac{e_n\sqrt{5}\pm\sqrt{5e_n^2+4(-1)^{n+1}}}{2}
\end{align*}
$(-1)^{n+1}$ will never have a greater magnitude than 1 (although it will be complex for some values of $n$). This implies that the true value of the $4(-1)^{n+1}$ term lies somewhere in the range $[-4,4]$. With a value as large as $e_n=4000000$, this term will hardly matter. However, because Problem 2 necessitates that this function return an upper bound, 4 (the largest value in $[-4,4]$) will be set as the permanent value\footnote{Note that this approximation may cause this method to run into trouble when $e_n$ is very close to an actual even Fibonacci number. For example, if $e_n$ is just lower in value than an even Fibonacci number, the formula may include that even Fibonacci number in the sum even though it shouldn't.}.
\begin{equation*}
    \gamma^{n+1} = \frac{e_n\sqrt{5}\pm\sqrt{5e_n^2+4}}{2}
\end{equation*}
Use logarithms to solve for $n$.
\begin{align*}
    \log_\gamma\left( \gamma^{n+1} \right) &= \log_\gamma\left( \frac{e_n\sqrt{5}\pm\sqrt{5e_n^2+4}}{2} \right)\\
    n+1 &= \log_\gamma\left( \frac{e_n\sqrt{5}\pm\sqrt{5e_n^2+4}}{2} \right)\\
    n &= \log_\gamma\left( \frac{e_n\sqrt{5}\pm\sqrt{5e_n^2+4}}{2} \right)-1
\end{align*}
Because $n$ must be positive, disregard the negative solution to the quadratic. Also return the substitution for $\gamma$\footnote{Note that for many large values of $e_n$, calculations could be simplified without affecting the significance of the output by ignoring the $+4$ term under the radical. If said term is ignored (which makes sense because as $e_n$ increases, $\sqrt{5e_n^2+4}$ increasingly behaves like $\sqrt{5e_n^2}$ --- formally, $\lim_{e_n\to\infty}\frac{\sqrt{5e_n^2+4}}{\sqrt{5e_n^2}}=1$), then the argument of the the logarithm algebraically reduces to just $e_n\sqrt{5}$.}.
\begin{equation}\label{eqn:n}
    n = \log_{2+\sqrt{5}}\left( \frac{e_n\sqrt{5}+\sqrt{5e_n^2+4}}{2} \right)-1
\end{equation}
\newpage



\section{Solving Problem 2}
\subsection{Mathematically}
Employ Equation \ref{eqn:n} to find an upper bound on the number of even Fibonacci numbers beneath four million.
\begin{align*}
    n &= \log_{2+\sqrt{5}}\left( \frac{4000000\sqrt{5}+\sqrt{5(4000000)^2+4}}{2} \right)-1\\
    &\approx 10.0876
\end{align*}
Since the upper bound is a decimal between 10 and 11, the $10^\text{th}$ even Fibonacci number is the greatest even Fibonacci number under four million.\par
Plug $n=10$ into Equation \ref{eqn:s_n} to find the sum of the even Fibonacci numbers beneath four million, solving Problem 2.
\begin{align*}
    s_{10} &= \frac{1}{20}\left( (5-\sqrt{5})(2+\sqrt{5})^{10+2}+(5+\sqrt{5})(2-\sqrt{5})^{10+2}-10 \right)\\
    \Aboxed{s_{10} &= 4613732}
\end{align*}


\subsection{Pythonically}
The following is a simple implementation of the above in Python.
\begin{lstlisting}
import math

def sumEvenFibonaccisBeneath(bound):
    n = math.floor(math.log((bound*5**0.5+(5*bound**2+4)**0.5)/2,2+5**0.5)-1)
    return int(1/20*((5-5**0.5)*(2+5**0.5)**(n+2)+(5+5**0.5)*(2-5**0.5)**(n+2)-10))


print(sumEvenFibonaccisBeneath(4*10**6))
\end{lstlisting}




\end{document}